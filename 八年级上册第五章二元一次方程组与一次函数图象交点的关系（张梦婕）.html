<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>二元一次方程组与一次函数图象交点关系</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Microsoft YaHei', Arial, sans-serif; background: #fff; padding: 20px; color: #333; }
        .container { max-width: 1200px; margin: 0 auto; }
        .title-section { text-align: center; margin-bottom: 30px; }
        .title-section h1 { font-size: 26px; margin-bottom: 10px; }
        .title-section .author { font-size: 18px; color: #666; margin-bottom: 8px; }
        .title-section p { font-size: 15px; color: #888; }
        .card { border: 1px solid #eee; border-radius: 8px; padding: 20px; margin-bottom: 20px; background: #fafafa; }
        .card h2 { font-size: 18px; margin-bottom: 15px; color: #444; }
        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; margin-bottom: 8px; font-weight: 500; }
        .input-row { display: flex; gap: 10px; margin-bottom: 10px; }
        .input-row input { flex: 1; padding: 8px; border: 1px solid #ccc; border-radius: 4px; text-align: center; font-size: 14px; }
        .btn { padding: 9px 15px; border: none; border-radius: 4px; font-size: 14px; cursor: pointer; }
        .btn-primary { background: #4285f4; color: white; }
        .btn-default { background: #f1f1f1; color: #333; }
        .btn-group { display: flex; gap: 10px; margin-bottom: 15px; }
        .btn-group .btn { flex: 1; }
        .preset-list { display: flex; flex-direction: column; gap: 8px; }
        .preset-btn { padding: 10px; border: 1px solid #ddd; border-radius: 4px; text-align: left; font-size: 14px; background: #fff; cursor: pointer; }
        .chart-container { width: 100%; height: 350px; border: 1px solid #eee; border-radius: 4px; margin-bottom: 20px; position: relative; }
        .function-formula { text-align: center; margin-bottom: 15px; padding: 10px; background: #fff; border-radius: 4px; border: 1px solid #eee; }
        .function-formula p { font-size: 15px; margin: 5px 0; }
        .formula-highlight { color: #4285f4; font-weight: 500; }
        .tabs { display: flex; border-bottom: 1px solid #eee; margin-bottom: 15px; }
        .tab { padding: 10px 20px; cursor: pointer; font-size: 14px; border-bottom: 2px solid transparent; }
        .tab.active { border-bottom-color: #4285f4; color: #4285f4; font-weight: 500; }
        .tab-content { display: none; font-size: 14px; line-height: 1.6; }
        .tab-content.active { display: block; }
        .result-box { border-left: 3px solid #4285f4; padding: 10px 15px; background: #f0f7ff; margin-bottom: 15px; }
        .steps-box { padding: 10px; background: #f8f8f8; border: 1px solid #eee; border-radius: 4px; font-size: 13px; }
        .grid-layout { display: grid; grid-template-columns: 350px 1fr; gap: 20px; }
        @media (max-width: 768px) { .grid-layout { grid-template-columns: 1fr; } }
        .loading { text-align: center; padding: 50px; color: #666; }
    </style>
</head>
<body>
    <div class="container">
        <!-- 标题区域 -->
        <div class="title-section">
            <h1>二元一次方程组与一次函数图象交点关系</h1>
            <p class="author">作者：张梦婕</p>
            <p>通过交互演示理解：方程组的解 ↔ 函数图象的交点坐标</p>
        </div>

        <div class="grid-layout">
            <!-- 左侧：参数输入区 -->
            <div class="left-section">
                <!-- 方程组输入卡片 -->
                <div class="card">
                    <h2>输入二元一次方程组</h2>
                    <p style="font-size: 13px; margin-bottom: 15px; color: #666;">
                        a₁x + b₁y = c₁<br>
                        a₂x + b₂y = c₂
                    </p>

                    <!-- 第一个方程 -->
                    <div class="input-group">
                        <label>第一个方程：a₁x + b₁y = c₁</label>
                        <div class="input-row">
                            <input type="number" step="0.1" value="1" id="a1">
                            <input type="number" step="0.1" value="-1" id="b1">
                            <input type="number" step="0.1" value="1" id="c1">
                        </div>
                    </div>

                    <!-- 第二个方程 -->
                    <div class="input-group">
                        <label>第二个方程：a₂x + b₂y = c₂</label>
                        <div class="input-row">
                            <input type="number" step="0.1" value="2" id="a2">
                            <input type="number" step="0.1" value="1" id="b2">
                            <input type="number" step="0.1" value="4" id="c2">
                        </div>
                    </div>

                    <!-- 操作按钮 -->
                    <div class="btn-group">
                        <button id="calculateBtn" class="btn btn-primary">计算并绘图</button>
                        <button id="resetBtn" class="btn btn-default">重置</button>
                    </div>
                </div>

                <!-- 预设案例卡片 -->
                <div class="card">
                    <h2>预设案例</h2>
                    <div class="preset-list">
                        <button class="preset-btn" data-case="1">案例1：唯一解（相交直线）</button>
                        <button class="preset-btn" data-case="2">案例2：无解（平行直线）</button>
                        <button class="preset-btn" data-case="3">案例3：无数解（重合直线）</button>
                    </div>
                </div>
            </div>

            <!-- 右侧：结果展示区 -->
            <div class="right-section">
                <!-- 图表展示卡片 -->
                <div class="card">
                    <h2>一次函数图象与交点</h2>
                    
                    <!-- 新增：函数表达式展示区 -->
                    <div class="function-formula">
                        <p>第一个方程对应的一次函数：<span id="func1Formula" class="formula-highlight">y = k₁x + b₁</span></p>
                        <p>第二个方程对应的一次函数：<span id="func2Formula" class="formula-highlight">y = k₂x + b₂</span></p>
                    </div>

                    <div class="chart-container">
                        <canvas id="functionChart"></canvas>
                        <div id="chartLoading" class="loading" style="display: none;">加载中...</div>
                    </div>
                </div>

                <!-- 结果分析卡片 -->
                <div class="card">
                    <div class="tabs">
                        <div class="tab active" data-tab="solution">方程组的解</div>
                        <div class="tab" data-tab="relation">关系分析</div>
                        <div class="tab" data-tab="principle">原理说明</div>
                    </div>

                    <!-- 方程组的解 -->
                    <div id="solutionTab" class="tab-content active">
                        <div class="result-box">
                            <h3 style="font-size: 15px; margin-bottom: 5px;">计算结果</h3>
                            <p id="solutionResult">点击"计算并绘图"按钮查看结果...</p>
                        </div>
                        <div class="steps-box">
                            <h4 style="font-size: 14px; margin-bottom: 5px;">解题步骤</h4>
                            <pre id="solutionSteps" style="white-space: pre-wrap; margin: 0;">等待计算...</pre>
                        </div>
                    </div>

                    <!-- 关系分析 -->
                    <div id="relationTab" class="tab-content">
                        <div style="margin-bottom: 15px; padding: 10px; background: #f5f3ff; border-radius: 4px;">
                            <h3 style="font-size: 15px; margin-bottom: 5px; color: #673ab7;">核心关系</h3>
                            <p>二元一次方程组的解，就是对应的两个一次函数图象的<strong style="color: #673ab7;">交点坐标</strong>。</p>
                        </div>
                        <div id="relationAnalysis">
                            <p>1. 每个二元一次方程都可以转化为一次函数 y = kx + b 的形式；</p>
                            <p>2. 两个函数图象的交点，其坐标(x, y)同时满足两个函数表达式；</p>
                            <p>3. 因此，这个坐标(x, y)就是原方程组的解。</p>
                        </div>
                    </div>

                    <!-- 原理说明 -->
                    <div id="principleTab" class="tab-content">
                        <p>1. <strong>方程与函数的转化</strong>：任何二元一次方程 ax + by = c（b≠0）都可以变形为 y = (-a/b)x + c/b，这是一次函数的标准形式，其中斜率 k = -a/b，截距 b = c/b。</p>
                        <p style="margin: 10px 0;">2. <strong>交点的几何意义</strong>：在平面直角坐标系中，一次函数的图象是一条直线。两个函数图象的交点，是同时在两条直线上的点，其坐标(x, y)满足两个函数的表达式。</p>
                        <p>3. <strong>三种情况对应</strong>：
                            <ul style="margin-left: 20px; margin-top: 5px;">
                                <li>当两个一次函数的斜率不相等时，直线相交，方程组有唯一解（一个交点）；</li>
                                <li>当两个一次函数的斜率相等但截距不相等时，直线平行，方程组无解（没有交点）；</li>
                                <li>当两个一次函数的斜率和截距都相等时，直线重合，方程组有无数解（无数个交点）。</li>
                            </ul>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const ctx = document.getElementById('functionChart').getContext('2d');
            const chartLoading = document.getElementById('chartLoading');
            let functionChart = null;

            // 初始化图表
            try {
                functionChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        datasets: [
                            { label: '函数1', data: [], borderColor: '#4285f4', borderWidth: 2, pointRadius: 0, fill: false },
                            { label: '函数2', data: [], borderColor: '#ea4335', borderWidth: 2, pointRadius: 0, fill: false },
                            { label: '交点', data: [], backgroundColor: '#34a853', pointRadius: 6, showLine: false }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: { type: 'linear', min: -10, max: 10, grid: { color: '#eee' }, ticks: { stepSize: 1 } },
                            y: { type: 'linear', min: -10, max: 10, grid: { color: '#eee' }, ticks: { stepSize: 1 } }
                        },
                        plugins: { legend: { position: 'top', labels: { font: { size: 12 } } } }
                    }
                });
            } catch (e) {
                alert('图表初始化失败，请刷新页面重试');
                return;
            }

            // 格式化函数表达式
            function formatFunction(a, b, c) {
                if (Math.abs(b) < 1e-6) {
                    // 垂直直线 x = 常数
                    const xVal = (c / a).toFixed(2);
                    return `x = ${xVal}`;
                } else {
                    // 斜截式 y = kx + b
                    const k = (-a / b).toFixed(2);
                    const bInter = (c / b).toFixed(2);
                    // 处理符号显示（避免+(-x)的情况）
                    if (bInter >= 0) {
                        return `y = ${k}x + ${bInter}`;
                    } else {
                        return `y = ${k}x - ${Math.abs(bInter)}`;
                    }
                }
            }

            // 求解方程组
            function solve(a1, b1, c1, a2, b2, c2) {
                const D = a1 * b2 - a2 * b1;
                if (Math.abs(D) < 1e-6) {
                    const D1 = c1 * b2 - c2 * b1;
                    const D2 = a1 * c2 - a2 * c1;
                    return Math.abs(D1) < 1e-6 && Math.abs(D2) < 1e-6 
                        ? { type: 'infinite', msg: '方程组有无数个解（直线重合）' }
                        : { type: 'no', msg: '方程组无解（直线平行）' };
                } else {
                    const x = (c1 * b2 - c2 * b1) / D;
                    const y = (a1 * c2 - a2 * c1) / D;
                    return { type: 'unique', x: x.toFixed(2), y: y.toFixed(2), msg: `唯一解：x=${x.toFixed(2)}, y=${y.toFixed(2)}` };
                }
            }

            // 生成函数数据
            function getFuncData(a, b, c) {
                const data = [];
                const xs = [-10, -5, 0, 5, 10];
                if (Math.abs(b) < 1e-6) {
                    const x = c / a || 0;
                    xs.forEach(y => data.push({ x: x, y: y }));
                } else {
                    const k = -a / b;
                    const bInter = c / b;
                    xs.forEach(x => data.push({ x: x, y: k * x + bInter }));
                }
                return data;
            }

            // 计算按钮事件
            document.getElementById('calculateBtn').addEventListener('click', function() {
                chartLoading.style.display = 'block';
                setTimeout(() => {
                    try {
                        // 获取输入值
                        const a1 = +document.getElementById('a1').value || 0;
                        const b1 = +document.getElementById('b1').value || 0;
                        const c1 = +document.getElementById('c1').value || 0;
                        const a2 = +document.getElementById('a2').value || 0;
                        const b2 = +document.getElementById('b2').value || 0;
                        const c2 = +document.getElementById('c2').value || 0;

                        // 验证输入
                        if ((!a1 && !b1) || (!a2 && !b2)) {
                            alert('a和b不能同时为0');
                            chartLoading.style.display = 'none';
                            return;
                        }

                        // 格式化并显示函数表达式
                        const func1Str = formatFunction(a1, b1, c1);
                        const func2Str = formatFunction(a2, b2, c2);
                        document.getElementById('func1Formula').textContent = func1Str;
                        document.getElementById('func2Formula').textContent = func2Str;

                        // 求解和更新结果
                        const res = solve(a1, b1, c1, a2, b2, c2);
                        document.getElementById('solutionResult').textContent = res.msg;
                        
                        // 生成解题步骤（包含函数转化过程）
                        let steps = '';
                        steps += `1. 将方程组转化为一次函数形式：\n`;
                        steps += `   第一个方程：${a1}x + ${b1}y = ${c1} → ${func1Str}\n`;
                        steps += `   第二个方程：${a2}x + ${b2}y = ${c2} → ${func2Str}\n`;
                        steps += `2. 计算行列式 D = ${a1}×${b2} - ${a2}×${b1} = ${(a1*b2 - a2*b1).toFixed(2)}\n`;

                        if (res.type === 'unique') {
                            steps += `3. D≠0，方程组有唯一解：\n`;
                            steps += `   x = (${c1}×${b2} - ${c2}×${b1})/D = ${res.x}\n`;
                            steps += `   y = (${a1}×${c2} - ${a2}×${c1})/D = ${res.y}\n`;
                            steps += `4. 函数图象交点坐标为 (${res.x}, ${res.y})，与方程组解一致`;
                        } else if (res.type === 'infinite') {
                            steps += `3. D=0，且两函数表达式完全相同，直线重合\n`;
                            steps += `4. 有无数个交点，方程组有无数解`;
                        } else {
                            steps += `3. D=0，两函数斜率相等但截距不同，直线平行\n`;
                            steps += `4. 无交点，方程组无解`;
                        }
                        document.getElementById('solutionSteps').textContent = steps;

                        // 更新图表
                        functionChart.data.datasets[0].data = getFuncData(a1, b1, c1);
                        functionChart.data.datasets[1].data = getFuncData(a2, b2, c2);
                        functionChart.data.datasets[2].data = res.type === 'unique' ? [{ x: +res.x, y: +res.y }] : [];
                        // 更新图例标签，包含函数表达式
                        functionChart.data.datasets[0].label = `函数1：${func1Str}`;
                        functionChart.data.datasets[1].label = `函数2：${func2Str}`;
                        functionChart.update();

                        // 更新关系分析
                        const k1 = Math.abs(b1) < 1e-6 ? '∞' : (-a1/b1).toFixed(2);
                        const k2 = Math.abs(b2) < 1e-6 ? '∞' : (-a2/b2).toFixed(2);
                        document.getElementById('relationAnalysis').innerHTML = `
                            <p>1. 转化后的一次函数：</p>
                            <p>   - 函数1：${func1Str}（斜率 k₁=${k1}）</p>
                            <p>   - 函数2：${func2Str}（斜率 k₂=${k2}）</p>
                            ${res.type === 'unique' 
                                ? `<p>2. 斜率 k₁≠k₂，直线相交，交点坐标(${res.x}, ${res.y})即为方程组的解</p>`
                                : res.type === 'infinite'
                                    ? `<p>2. 斜率 k₁=k₂ 且截距相等，直线重合，无数个交点（无数解）</p>`
                                    : `<p>2. 斜率 k₁=k₂ 但截距不同，直线平行，无交点（无解）</p>`
                            }
                        `;
                    } catch (e) {
                        alert('计算出错，请检查输入');
                    } finally {
                        chartLoading.style.display = 'none';
                    }
                }, 300);
            });

            // 重置按钮事件
            document.getElementById('resetBtn').addEventListener('click', function() {
                document.getElementById('a1').value = 1;
                document.getElementById('b1').value = -1;
                document.getElementById('c1').value = 1;
                document.getElementById('a2').value = 2;
                document.getElementById('b2').value = 1;
                document.getElementById('c2').value = 4;
                document.getElementById('solutionResult').textContent = '点击"计算并绘图"按钮查看结果...';
                document.getElementById('solutionSteps').textContent = '等待计算...';
                document.getElementById('func1Formula').textContent = 'y = k₁x + b₁';
                document.getElementById('func2Formula').textContent = 'y = k₂x + b₂';
                functionChart.data.datasets.forEach(d => d.data = []);
                functionChart.data.datasets[0].label = '函数1';
                functionChart.data.datasets[1].label = '函数2';
                functionChart.update();
            });

            // 预设案例事件
            document.querySelectorAll('.preset-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const cases = {
                        '1': [1, -1, 1, 2, 1, 4],
                        '2': [1, 2, 3, 2, 4, 5],
                        '3': [2, 4, 6, 1, 2, 3]
                    };
                    const [a1, b1, c1, a2, b2, c2] = cases[this.dataset.case];
                    document.getElementById('a1').value = a1;
                    document.getElementById('b1').value = b1;
                    document.getElementById('c1').value = c1;
                    document.getElementById('a2').value = a2;
                    document.getElementById('b2').value = b2;
                    document.getElementById('c2').value = c2;
                    document.getElementById('calculateBtn').click();
                });
            });

            // 标签切换事件
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    document.getElementById(this.dataset.tab + 'Tab').classList.add('active');
                });
            });

            // 初始计算
            document.getElementById('calculateBtn').click();
        });
    </script>
</body>
</html>