<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>二次函数顶点式 a,h,k 影响演示 - 陕西中学数学课件</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&family=Roboto:wght@400;500;700&display=swap');
        body {
            font-family: 'Noto Sans SC', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        .card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }
        .slider::-webkit-slider-thumb {
            transition: all 0.2s ease;
        }
        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }
        .vertex-marker {
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            width: 6px; /* 缩小顶点大小（原4px调整为6px？不，原是w-4即16px，现改为6px） */
            height: 6px;
        }
        .number-input {
            width: 70px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 2px 0;
            transition: border 0.2s ease;
        }
        .number-input:focus {
            outline: none;
            border-color: #1E88E5;
        }
        .param-row {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%;
        }
        /* 顶点坐标文字透明样式 */
        .vertex-label {
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>
<body class="container mx-auto px-4 py-8">
    <header class="text-center mb-6">
        <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-2">二次函数顶点式 <span class="text-blue-600">y=a(x-h)²+k</span> 动态演示</h1>
        <p class="text-gray-600 text-lg">作者：雷新风</p >
    </header>

    <main class="space-y-6">
        <!-- 图像展示区 -->
        <section class="card p-6">
            <div class="h-[380px] relative">
                <canvas id="parabola-chart"></canvas>
                <!-- 顶点标记（缩小后） -->
                <div id="vertex-marker" class="vertex-marker absolute bg-red-500 rounded-full -translate-x-1/2 -translate-y-1/2 shadow-lg" style="top: 190px; left: 300px;">
                    <div class="vertex-label absolute -top-8 left-1/2 -translate-x-1/2 bg-white px-2 py-1 rounded text-sm font-medium shadow-md">
                        顶点(0,0)
                    </div>
                </div>
            </div>
        </section>

        <!-- 精简控制区 -->
        <section class="card p-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- a值控制 -->
                <div class="param-row">
                    <label for="a-slider" class="text-gray-600 font-medium">a：</label>
                    <span id="a-value" class="font-bold text-blue-600 text-lg w-16 text-right">1.00</span>
                    <input type="number" id="a-input" class="number-input" min="-3" max="3" step="0.01" value="1.00">
                    <input 
                        type="range" 
                        id="a-slider" 
                        class="slider flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="-300" 
                        max="300" 
                        step="1" 
                        value="100"
                    >
                </div>
                <!-- h值控制 -->
                <div class="param-row">
                    <label for="h-slider" class="text-gray-600 font-medium">h：</label>
                    <span id="h-value" class="font-bold text-green-600 text-lg w-16 text-right">0.0</span>
                    <input type="number" id="h-input" class="number-input" min="-5" max="5" step="0.1" value="0.0">
                    <input 
                        type="range" 
                        id="h-slider" 
                        class="slider flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="-50" 
                        max="50" 
                        step="1" 
                        value="0"
                    >
                </div>
                <!-- k值控制 -->
                <div class="param-row">
                    <label for="k-slider" class="text-gray-600 font-medium">k：</label>
                    <span id="k-value" class="font-bold text-red-600 text-lg w-16 text-right">0.0</span>
                    <input type="number" id="k-input" class="number-input" min="-5" max="5" step="0.1" value="0.0">
                    <input 
                        type="range" 
                        id="k-slider" 
                        class="slider flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        min="-50" 
                        max="50" 
                        step="1" 
                        value="0"
                    >
                </div>
            </div>
        </section>

        <!-- 函数表达式与规律总结区 -->
        <section class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- 当前函数表达式 -->
            <div class="card p-6 bg-blue-50">
                <h2 class="text-lg font-semibold text-gray-700 mb-4 flex items-center">
                    <i class="fas fa-formula text-blue-600 mr-2"></i>当前函数表达式
                </h2>
                <div id="function-formula" class="text-xl font-bold text-center text-blue-700 py-3 bg-white rounded-lg shadow-sm">
                    y = 1.00x² + 0.0
                </div>
                <div id="vertex-formula" class="text-center text-gray-600 mt-3 text-base">
                    顶点坐标：(0.0, 0.0)
                </div>
            </div>

            <!-- 规律总结 -->
            <div class="card p-6">
                <h2 class="text-lg font-semibold text-gray-700 mb-4 flex items-center">
                    <i class="fas fa-bookmark text-orange-500 mr-2"></i>参数影响规律总结
                </h2>
                <div class="space-y-3 text-gray-600 text-base">
                    <div class="p-3 bg-orange-50 rounded-lg">
                        <p class="font-medium text-orange-700">✓ a（开口方向与宽窄）</p >
                        <p>• a > 0 向上；a < 0 向下</p >
                        <p>• |a| 越大，开口越窄；反之越宽</p >
                    </div>
                    <div class="p-3 bg-green-50 rounded-lg">
                        <p class="font-medium text-green-700">✓ h（水平平移）</p >
                        <p>• h > 0 右移；h < 0 左移（移|h|个单位）</p >
                        <p>• 顶点横坐标 = h</p >
                    </div>
                    <div class="p-3 bg-red-50 rounded-lg">
                        <p class="font-medium text-red-700">✓ k（垂直平移）</p >
                        <p>• k > 0 上移；k < 0 下移（移|k|个单位）</p >
                        <p>• 顶点纵坐标 = k</p >
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="mt-10 text-center text-gray-500 text-sm">
        <p>© 2025 陕西中学数学教学课件 | 动态交互式二次函数演示</p >
    </footer>

    <script>
        // 获取DOM元素
        const aSlider = document.getElementById('a-slider');
        const hSlider = document.getElementById('h-slider');
        const kSlider = document.getElementById('k-slider');
        const aInput = document.getElementById('a-input');
        const hInput = document.getElementById('h-input');
        const kInput = document.getElementById('k-input');
        const aValue = document.getElementById('a-value');
        const hValue = document.getElementById('h-value');
        const kValue = document.getElementById('k-value');
        const functionFormula = document.getElementById('function-formula');
        const vertexFormula = document.getElementById('vertex-formula');
        const vertexMarker = document.getElementById('vertex-marker');
        const ctx = document.getElementById('parabola-chart').getContext('2d');

        // 初始化图表
        let parabolaChart = new Chart(ctx, {
            type: 'line',
            data: {
                datasets: [{
                    label: '抛物线',
                    borderColor: '#1E88E5',
                    borderWidth: 3,
                    pointRadius: 0,
                    tension: 0.1,
                    fill: false,
                    data: generateParabolaData(1, 0, 0),
                    borderJoinStyle: 'round'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: { duration: 0 },
                scales: {
                    x: {
                        type: 'linear',
                        position: 'center',
                        min: -10,
                        max: 10,
                        stepSize: 1,
                        grid: { color: 'rgba(0, 0, 0, 0.1)', borderDash: [5, 5] },
                        ticks: { font: { size: 12 } },
                        border: { display: false }
                    },
                    y: {
                        type: 'linear',
                        position: 'center',
                        min: -10,
                        max: 10,
                        stepSize: 1,
                        grid: { color: 'rgba(0, 0, 0, 0.1)', borderDash: [5, 5] },
                        ticks: { font: { size: 12 } },
                        border: { display: false }
                    }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: { enabled: false },
                    title: { display: false }
                },
                interaction: { intersect: false, mode: 'index' },
                elements: { line: { tension: 0.1 } }
            }
        });

        // 格式化数字显示
        function formatNumber(num, decimalPlaces) {
            return num.toFixed(decimalPlaces);
        }

        // 更新函数表达式
        function updateFormula(a, h, k) {
            let hTerm = h === 0 ? 'x' : `(x - ${h > 0 ? formatNumber(h, 1) : `(${formatNumber(h, 1)})`})`;
            let kTerm = k === 0 ? '' : (k > 0 ? ` + ${formatNumber(k, 1)}` : ` - ${formatNumber(Math.abs(k), 1)}`);
            let aTerm = a === 1 ? '' : a === -1 ? '-' : formatNumber(a, 2);
            
            functionFormula.textContent = `y = ${aTerm}${hTerm}²${kTerm}`;
            vertexFormula.textContent = `顶点坐标：(${formatNumber(h, 1)}, ${formatNumber(k, 1)})`;
        }

        // 更新顶点标记位置
        function updateVertexMarker(h, k) {
            const chart = parabolaChart;
            const xAxis = chart.scales.x;
            const yAxis = chart.scales.y;
            
            const x = xAxis.getPixelForValue(h);
            const y = yAxis.getPixelForValue(k);
            
            vertexMarker.style.left = `${x}px`;
            vertexMarker.style.top = `${y}px`;
            vertexMarker.querySelector('.vertex-label').textContent = `顶点(${formatNumber(h, 1)},${formatNumber(k, 1)})`;
        }

        // 生成抛物线数据
        function generateParabolaData(a, h, k) {
            const data = [];
            for (let x = -10; x <= 10; x += 0.05) {
                const y = a * Math.pow(x - h, 2) + k;
                if (y >= -10 && y <= 10) {
                    data.push({ x, y });
                }
            }
            return data;
        }

        // 防抖函数
        function debounce(func, wait) {
            let timeout;
            return function() {
                clearTimeout(timeout);
                timeout = setTimeout(() => func.apply(this, arguments), wait);
            };
        }

        // 更新图表
        const updateChart = debounce(() => {
            let a = parseFloat(aSlider.value)/100;
            let h = parseFloat(hSlider.value)/10;
            let k = parseFloat(kSlider.value)/10;
            
            // 更新参数显示
            aInput.value = formatNumber(a, 2);
            hInput.value = formatNumber(h, 1);
            kInput.value = formatNumber(k, 1);
            aValue.textContent = formatNumber(a, 2);
            hValue.textContent = formatNumber(h, 1);
            kValue.textContent = formatNumber(k, 1);
            
            // 更新函数表达式和顶点
            updateFormula(a, h, k);
            updateVertexMarker(h, k);
            
            // 更新图表数据
            parabolaChart.data.datasets[0].data = generateParabolaData(a, h, k);
            parabolaChart.data.datasets[0].borderColor = a > 0 ? '#1E88E5' : '#E53935';
            parabolaChart.update();
        }, 30);

        // 输入框同步到滑块
        function syncInputToSlider(inputElement, sliderElement, multiplier) {
            const value = parseFloat(inputElement.value);
            const min = parseFloat(inputElement.min);
            const max = parseFloat(inputElement.max);
            if (isNaN(value) || value < min || value > max) {
                inputElement.value = inputElement.defaultValue;
                return;
            }
            sliderElement.value = value * multiplier;
            updateChart();
        }

        // 初始化图表数据
        updateChart();

        // 事件监听
        aSlider.addEventListener('input', updateChart);
        hSlider.addEventListener('input', updateChart);
        kSlider.addEventListener('input', updateChart);
        aInput.addEventListener('change', () => syncInputToSlider(aInput, aSlider, 100));
        hInput.addEventListener('change', () => syncInputToSlider(hInput, hSlider, 10));
        kInput.addEventListener('change', () => syncInputToSlider(kInput, kSlider, 10));

        // 窗口 resize 适配
        window.addEventListener('resize', () => {
            parabolaChart.resize();
            const h = parseFloat(hSlider.value)/10;
            const k = parseFloat(kSlider.value)/10;
            updateVertexMarker(h, k);
        });
    </script>
</body>
</html>