<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>二次函数y=x²动态绘图</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { padding: 15px; font-family: Arial, sans-serif; background: #f5f5f5; }
        .container { max-width: 90%; margin: 0 auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #2c3e50; margin-bottom: 20px; font-size: 20px; }
        /* 概念和性质板块样式 */
        .concept-box, .property-box { 
            margin: 20px 0; 
            padding: 15px; 
            border-radius: 6px; 
            background: #f8f9fa; 
            border-left: 4px solid #3498db; 
        }
        .property-box { border-left-color: #2ecc71; }
        .box-title { 
            font-size: 16px; 
            font-weight: 600; 
            color: #2c3e50; 
            margin-bottom: 10px; 
        }
        .box-content { 
            font-size: 14px; 
            color: #34495e; 
            line-height: 1.6; 
        }
        /* 窄表格 */
        .table-container { margin: 20px 0; overflow-x: auto; }
        table { margin: 0 auto; border-collapse: collapse; }
        th, td { border: 1px solid #333; padding: 4px 4px; text-align: center; min-width: 20px; font-size: 12px; }
        th { background: #f2f2f2; }
        .cell-hidden { display: none; }
        .cell-show { display: table-cell; }
        .ellipsis { color: #666; }
        /* 画布容器 */
        .canvas-box { width: 100%; height: 400px; border: 1px solid #333; margin: 20px auto; position: relative; }
        canvas { width: 100%; height: 100%; display: block; }
        /* 滑动条 - 60%宽度居中 */
        .slider-wrap { margin: 15px 0; padding: 15px; background: #f9f9fa; border-radius: 6px; text-align: center; }
        label { display: block; margin-bottom: 8px; color: #34495e; font-size: 14px; font-weight: 600; text-align: left; }
        .slider-container { width: 60%; margin: 0 auto; }
        input[type="range"] { width: 100%; height: 8px; border-radius: 4px; background: #eee; outline: none; -webkit-appearance: none; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 18px; height: 18px; border-radius: 50%; background: #3498db; cursor: pointer; }
        input[type="range"]:disabled::-webkit-slider-thumb { background: #bdc3c7; cursor: not-allowed; }
        .status { text-align: center; margin-top: 8px; color: #666; font-size: 12px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>二次函数y=x²动态绘图演示</h1>
        作者  雷新风
        <!-- 坐标表格 -->
        <div class="table-container">
            <table id="coordTable">
                <tr>
                    <<th>x</</th> <!-- 修复：移除多余的<符号 -->
                    <td class="ellipsis cell-show">...</td>
                    <td id="x-3" class="cell-hidden">-3</td>
                    <td id="x-2" class="cell-hidden">-2</td>
                    <td id="x-1" class="cell-hidden">-1</td>
                    <td id="x0" class="cell-hidden">0</td>
                    <td id="x1" class="cell-hidden">1</td>
                    <td id="x2" class="cell-hidden">2</td>
                    <td id="x3" class="cell-hidden">3</td>
                    <td class="ellipsis cell-show">...</td>
                </tr>
                <tr>
                    <<th>y</</th> <!-- 修复：移除多余的<符号 -->
                    <td class="ellipsis cell-show">...</td>
                    <td id="y-3" class="cell-hidden">9</td>
                    <td id="y-2" class="cell-hidden">4</td>
                    <td id="y-1" class="cell-hidden">1</td>
                    <td id="y0" class="cell-hidden">0</td>
                    <td id="y1" class="cell-hidden">1</td>
                    <td id="y2" class="cell-hidden">4</td>
                    <td id="y3" class="cell-hidden">9</td>
                    <td class="ellipsis cell-show">...</td>
                </tr>
            </table>
        </div>
        
        <!-- 画布 -->
        <div class="canvas-box">
            <canvas id="functionCanvas"></canvas>
        </div>
        
        <!-- 三个滑动条 -->
        <div class="slider-wrap">
            <label for="tableSlider">1. 显示坐标</label>
            <div class="slider-container">
                <input type="range" id="tableSlider" min="0" max="7" value="0" step="1">
            </div>
            <div class="status" id="tableStatus">未显示坐标</div>
        </div>
        
        <div class="slider-wrap">
            <label for="pointSlider">2. 描点</label>
            <div class="slider-container">
                <input type="range" id="pointSlider" min="0" max="7" value="0" step="1" disabled>
            </div>
            <div class="status" id="pointStatus">未描点</div>
        </div>
        
        <div class="slider-wrap">
            <label for="lineSlider">3. 绘制光滑曲线</label>
            <div class="slider-container">
                <input type="range" id="lineSlider" min="0" max="100" value="0" step="1" disabled>
            </div>
            <div class="status" id="lineStatus">未绘制曲线</div>
        </div>
        
        <!-- 抛物线相关概念板块 -->
        <div class="concept-box">
            <div class="box-title">一、抛物线相关概念</div>
            <div class="box-content">
                1. 我们刚才绘制的这个曲线，叫做<strong>抛物线</strong>，它是二次函数的图像；<br>
                2. 抛物线y=x²是一个<strong>轴对称图形</strong>；<br>
                3. 对称轴与抛物线的交点，叫做抛物线的<strong>顶点</strong>。
            </div>
        </div>
        
        <!-- y=x²的性质板块 -->
        <div class="property-box">
            <div class="box-title">二、二次函数y=x²的性质</div>
            <div class="box-content">
                1. <strong>开口方向</strong>：向上；<br>
                2. <strong>对称轴</strong>：y轴（即直线x=0）；<br>
                3. <strong>增减性</strong>：在y轴左侧（x<0），y随x的增大而减小；在y轴右侧（x>0），y随x的增大而增大；<br>
                4. <strong>顶点</strong>：抛物线的最低点，坐标为(0, 0)；<br>
                5. <strong>最值</strong>：函数有最小值，当x=0时，y的最小值为0。
            </div>
        </div>
    </div>

    <script>
        // 确保DOM完全加载后执行
        document.addEventListener('DOMContentLoaded', function() {
            // 1. 获取所有元素
            const canvas = document.getElementById('functionCanvas');
            const ctx = canvas.getContext('2d');
            const tableSlider = document.getElementById('tableSlider');
            const pointSlider = document.getElementById('pointSlider');
            const lineSlider = document.getElementById('lineSlider');
            const tableStatus = document.getElementById('tableStatus');
            const pointStatus = document.getElementById('pointStatus');
            const lineStatus = document.getElementById('lineStatus');
            
            // 2. 核心数据：x从-3到3的坐标（y=x²）
            const coords = [
                { x: -3, y: 9 },
                { x: -2, y: 4 },
                { x: -1, y: 1 },
                { x: 0, y: 0 },
                { x: 1, y: 1 },
                { x: 2, y: 4 },
                { x: 3, y: 9 }
            ];
            
            // 3. 画布初始化：自适应尺寸并绘制完整坐标系
            function initCanvas() {
                const box = canvas.parentElement;
                canvas.width = box.clientWidth;
                canvas.height = box.clientHeight;
                drawCompleteAxis(); // 绘制完整坐标系
            }
            
            // 4. 修复：绘制完整坐标系（包含箭头、刻度、标签）
            function drawCompleteAxis() {
                const cw = canvas.width;
                const ch = canvas.height;
                const centerX = cw / 2; // x轴中点（原点x坐标）
                const centerY = ch * 0.8; // y轴下方（原点y坐标）
                const scale = Math.min(cw / 12, ch / 26); // 缩放比例（适配画布）
                const tickLength = 2; // 刻度线长度
                
                // 清空画布
                ctx.clearRect(0, 0, cw, ch);
                ctx.fillStyle = '#000';
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 2;
                
                // 绘制X轴（带箭头）
                ctx.beginPath();
                ctx.moveTo(30, centerY); // 左起点（留边距）
                ctx.lineTo(cw - 30, centerY); // 右终点
                ctx.stroke();
                // X轴箭头
                ctx.beginPath();
                ctx.moveTo(cw - 30, centerY);
                ctx.lineTo(cw - 38, centerY - 5);
                ctx.lineTo(cw - 38, centerY + 5);
                ctx.fill();
                // X轴标签
                ctx.font = '14px Arial';
                ctx.fillText('x轴', cw - 45, centerY - 10);
                
                // 绘制Y轴（带箭头）
                ctx.beginPath();
                ctx.moveTo(centerX, 30); // 上起点（留边距）
                ctx.lineTo(centerX, ch - 30); // 下终点
                ctx.stroke();
                // Y轴箭头
                ctx.beginPath();
                ctx.moveTo(centerX, 30);
                ctx.lineTo(centerX - 5, 38);
                ctx.lineTo(centerX + 5, 38);
                ctx.fill();
                // Y轴标签
                ctx.fillText('y轴', centerX - 25, 45);
                
                // 绘制X轴刻度（-5到5，间隔1）
                ctx.font = '12px Arial';
                for (let i = -5; i <= 5; i++) {
                    const x = centerX + i * scale;
                    if (x >= 30 && x <= cw - 30) { // 只绘制在画布内的刻度
                        ctx.beginPath();
                        ctx.moveTo(x, centerY - tickLength);
                        ctx.lineTo(x, centerY + tickLength);
                        ctx.stroke();
                        ctx.fillText(i, x - 3, centerY + 15);
                    }
                }
                
                // 绘制Y轴刻度（1到25，间隔1）
                for (let i = 1; i <= 25; i++) {
                    const y = centerY - i * scale;
                    if (y >= 30 && y <= ch - 30) { // 只绘制在画布内的刻度
                        ctx.beginPath();
                        ctx.moveTo(centerX - tickLength, y);
                        ctx.lineTo(centerX + tickLength, y);
                        ctx.stroke();
                        ctx.fillText(i, centerX + 6, y + 4);
                    }
                }
                
                // 原点标签
                ctx.fillText('O', centerX + 8, centerY - 8);
            }
            
            // 5. 第一个滑动条：显示坐标表格
            function updateTable(step) {
                // 隐藏所有坐标单元格
                coords.forEach((item, index) => {
                    document.getElementById(`x${item.x}`).className = 'cell-hidden';
                    document.getElementById(`y${item.x}`).className = 'cell-hidden';
                });
                
                // 显示前step个坐标
                for (let i = 0; i < step; i++) {
                    const item = coords[i];
                    document.getElementById(`x${item.x}`).className = 'cell-show';
                    document.getElementById(`y${item.x}`).className = 'cell-show';
                }
                
                // 更新状态并控制第二个滑动条
                if (step === 0) {
                    tableStatus.textContent = '未显示坐标';
                    pointSlider.disabled = true;
                    pointSlider.value = 0;
                } else {
                    const showCoords = coords.slice(0, step).map(c => `(${c.x},${c.y})`).join(' ');
                    tableStatus.textContent = `显示坐标：${showCoords}`;
                    pointSlider.disabled = false;
                }
            }
            
            // 6. 修复：第二个滑动条（描点功能）
            function drawPoints(step) {
                drawCompleteAxis(); // 先绘制完整坐标系
                const cw = canvas.width;
                const ch = canvas.height;
                const centerX = cw / 2;
                const centerY = ch * 0.8;
                const scale = Math.min(cw / 12, ch / 26);
                
                // 绘制前step个点
                for (let i = 0; i < step; i++) {
                    const { x, y } = coords[i];
                    const px = centerX + x * scale; // 转换为画布x坐标
                    const py = centerY - y * scale; // 转换为画布y坐标（y轴向上为负）
                    
                    // 绘制红色实心点（半径3px）
                    ctx.beginPath();
                    ctx.arc(px, py, 3, 0, Math.PI * 2);
                    ctx.fillStyle = '#e74c3c';
                    ctx.fill();
                    ctx.strokeStyle = '#000';
                    ctx.stroke();
                    
                    // 绘制坐标标签（避免遮挡）
                    ctx.font = '12px Arial';
                    ctx.fillStyle = '#000';
                    if (x < 0) {
                        ctx.fillText(`(${x},${y})`, px - 25, py - 8); // 左侧点：左上角
                    } else if (x > 0) {
                        ctx.fillText(`(${x},${y})`, px + 8, py - 8); // 右侧点：右上角
                    }
                }
                
                // 更新状态并控制第三个滑动条
                if (step === 0) {
                    pointStatus.textContent = '未描点';
                    lineSlider.disabled = true;
                    lineSlider.value = 0;
                } else {
                    pointStatus.textContent = `已描${step}个点`;
                    lineSlider.disabled = step < 2; // 至少2个点才启用曲线滑动条
                }
            }
            

// 7. 第三个滑动条（绘制曲线功能）
            function drawCurve(progress) {
                drawPoints(parseInt(pointSlider.value)); // 先绘制已描的点
                const cw = canvas.width;
                const ch = canvas.height;
                const centerX = cw / 2;
                const centerY = ch * 0.8;
                const scale = Math.min(cw / 12, ch / 26);
                
                if (progress > 0) {
                    // 生成从x=-5到x=5的密集点（根据进度显示）
                    const maxX = -5 + (progress / 100) * 10; // 进度100时x到5
                    ctx.beginPath();
                    ctx.strokeStyle = '#3498db'; // 蓝色曲线
                    ctx.lineWidth = 3;
                    
                    for (let x = -5; x <= maxX; x += 0.01) {
                        const y = Math.pow(x, 2);
                        const px = centerX + x * scale;
                        const py = centerY - y * scale;
                        
                        if (y <= 25) { // 只绘制y≤25的部分（避免超出画布）
                            x === -5 ? ctx.moveTo(px, py) : ctx.lineTo(px, py);
                        }
                    }
                    
                    ctx.stroke();
                    lineStatus.textContent = `已绘制到x=${maxX.toFixed(1)}的曲线`;
                } else {
                    lineStatus.textContent = '未绘制曲线';
                }
            }
            
            // 8. 绑定所有滑动条事件
            tableSlider.addEventListener('input', function() {
                updateTable(parseInt(this.value));
            });
            
            pointSlider.addEventListener('input', function() {
                drawPoints(parseInt(this.value));
            });
            
            lineSlider.addEventListener('input', function() {
                drawCurve(parseInt(this.value));
            });
            
            // 9. 窗口缩放时自适应画布
            window.addEventListener('resize', initCanvas);
            
            // 10. 初始化页面
            initCanvas();
            updateTable(0);
        });
    </script>
</body>
</html>