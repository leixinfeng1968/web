<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>九年级上册第一章菱形性质探究</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        #svgContainer {
            display: block;
            margin: 0 auto;
            background-color: #fafafa;
            border: 1px solid #ddd;
        }
        .controls {
            margin: 20px 0;
            text-align: center;
        }
        .control-group {
            margin: 10px 0;
        }
        label {
            display: inline-block;
            width: 150px;
            font-weight: bold;
        }
        input[type="range"] {
            width: 200px;
        }
        .properties {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 8px;
        }
        .property-item {
            text-align: center;
        }
        .property-label {
            font-weight: bold;
            color: #666;
        }
        .property-value {
            font-size: 18px;
            color: #333;
            font-weight: bold;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>菱形性质探究</h1>
        <div class="controls">
            <div class="control-group">
                <label for="sideLength">边长：</label>
                <input type="range" id="sideLength" min="50" max="200" value="100">
                <span id="sideLengthValue">100</span>
            </div>
            <div class="control-group">
                <label for="angle">角度（°）：</label>
                <input type="range" id="angle" min="30" max="150" value="60">
                <span id="angleValue">60</span>
            </div>
            <div class="control-group">
                <button id="toggleDiagonals">显示对角线</button>
                <button id="reset">重置</button>
            </div>
        </div>
        <svg id="svgContainer" width="500" height="500"></svg>
        <div class="properties">
            <div class="property-item">
                <div class="property-label">AB边长</div>
                <div class="property-value" id="abLen">100.0</div>
            </div>
            <div class="property-item">
                <div class="property-label">BC边长</div>
                <div class="property-value" id="bcLen">100.0</div>
            </div>
            <div class="property-item">
                <div class="property-label">CD边长</div>
                <div class="property-value" id="cdLen">100.0</div>
            </div>
            <div class="property-item">
                <div class="property-label">DA边长</div>
                <div class="property-value" id="daLen">100.0</div>
            </div>
            <div class="property-item">
                <div class="property-label">∠A</div>
                <div class="property-value" id="angleA">60.0</div>
            </div>
            <div class="property-item">
                <div class="property-label">∠B</div>
                <div class="property-value" id="angleB">120.0</div>
            </div>
            <div class="property-item">
                <div class="property-label">对角线AC</div>
                <div class="property-value" id="acLen">173.2</div>
            </div>
            <div class="property-item">
                <div class="property-label">对角线BD</div>
                <div class="property-value" id="bdLen">100.0</div>
            </div>
            <div class="property-item">
                <div class="property-label">对角线夹角</div>
                <div class="property-value" id="diagAngle">90.0</div>
            </div>
            <div class="property-item">
                <div class="property-label">∠BAC</div>
                <div class="property-value" id="angleBAC">30.0</div>
            </div>
            <div class="property-item">
                <div class="property-label">∠CAD</div>
                <div class="property-value" id="angleCAD">30.0</div>
            </div>
        </div>
    </div>

    <script>
        // 全局变量
        const svg = document.getElementById('svgContainer');
        const sideLengthSlider = document.getElementById('sideLength');
        const angleSlider = document.getElementById('angle');
        const sideLengthValue = document.getElementById('sideLengthValue');
        const angleValue = document.getElementById('angleValue');
        const toggleDiagonalsBtn = document.getElementById('toggleDiagonals');
        const resetBtn = document.getElementById('reset');
        
        // 属性显示元素
        const abLen = document.getElementById('abLen');
        const bcLen = document.getElementById('bcLen');
        const cdLen = document.getElementById('cdLen');
        const daLen = document.getElementById('daLen');
        const angleA = document.getElementById('angleA');
        const angleB = document.getElementById('angleB');
        const acLen = document.getElementById('acLen');
        const bdLen = document.getElementById('bdLen');
        const diagAngle = document.getElementById('diagAngle');
        const angleBAC = document.getElementById('angleBAC');
        const angleCAD = document.getElementById('angleCAD');
        
        // 菱形数据
        let rhombus = {
            A: { x: 0, y: 0 },
            B: { x: 0, y: 0 },
            C: { x: 0, y: 0 },
            D: { x: 0, y: 0 }
        };
        
        let showDiagonal = false;
        let currentSideLength = 100;
        let currentAngle = 60;
        
        // 计算两点之间的距离
        function distance(x1, y1, x2, y2) {
            return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
        }
        
        // 计算三点之间的角度（点2是顶点）
        function calcAngle(point1, point2, point3) {
            const dx1 = point1.x - point2.x;
            const dy1 = point1.y - point2.y;
            const dx2 = point3.x - point2.x;
            const dy2 = point3.y - point2.y;
            
            const dotProduct = dx1 * dx2 + dy1 * dy2;
            const magnitude1 = Math.sqrt(dx1 * dx1 + dy1 * dy1);
            const magnitude2 = Math.sqrt(dx2 * dx2 + dy2 * dy2);
            
            if (magnitude1 === 0 || magnitude2 === 0) return 0;
            
            const cosAngle = dotProduct / (magnitude1 * magnitude2);
            // 处理浮点数精度问题
            const clampedCos = Math.max(-1, Math.min(1, cosAngle));
            
            const angleRad = Math.acos(clampedCos);
            return angleRad * (180 / Math.PI);
        }
        
        // 计算菱形的四个顶点
        function calculateRhombus(sideLength, angleDegrees) {
            const centerX = svg.width.baseVal.value / 2;
            const centerY = svg.height.baseVal.value / 2;
            const angleRadians = angleDegrees * Math.PI / 180;
            
            // 菱形的四个顶点
            const A = {
                x: centerX - sideLength / 2,
                y: centerY
            };
            
            const B = {
                x: centerX + sideLength / 2,
                y: centerY
            };
            
            const C = {
                x: centerX + sideLength / 2 + sideLength * Math.cos(angleRadians),
                y: centerY + sideLength * Math.sin(angleRadians)
            };
            
            const D = {
                x: centerX - sideLength / 2 + sideLength * Math.cos(angleRadians),
                y: centerY + sideLength * Math.sin(angleRadians)
            };
            
            return { A, B, C, D };
        }
        
        // 绘制菱形
        function drawRhombus() {
            // 清空SVG
            while (svg.firstChild) {
                svg.removeChild(svg.firstChild);
            }
            
            // 创建菱形路径
            const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            const d = `M ${rhombus.A.x} ${rhombus.A.y} L ${rhombus.B.x} ${rhombus.B.y} L ${rhombus.C.x} ${rhombus.C.y} L ${rhombus.D.x} ${rhombus.D.y} Z`;
            path.setAttribute('d', d);
            path.setAttribute('fill', '#4CAF50');
            path.setAttribute('stroke', '#333');
            path.setAttribute('stroke-width', '2');
            path.setAttribute('opacity', '0.7');
            svg.appendChild(path);
            
            // 绘制顶点
            const vertices = [rhombus.A, rhombus.B, rhombus.C, rhombus.D];
            const labels = ['A', 'B', 'C', 'D'];
            
            vertices.forEach((vertex, index) => {
                // 顶点圆圈
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', vertex.x);
                circle.setAttribute('cy', vertex.y);
                circle.setAttribute('r', '8');
                circle.setAttribute('fill', '#FF5722');
                circle.setAttribute('stroke', '#333');
                circle.setAttribute('stroke-width', '2');
                svg.appendChild(circle);
                
                // 顶点标签
                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', vertex.x + 12);
                text.setAttribute('y', vertex.y - 12);
                text.setAttribute('font-size', '16');
                text.setAttribute('font-weight', 'bold');
                text.setAttribute('fill', '#333');
                text.textContent = labels[index];
                svg.appendChild(text);
            });
            
            // 绘制对角线
            if (showDiagonal) {
                // 对角线AC
                const diagonalAC = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                diagonalAC.setAttribute('x1', rhombus.A.x);
                diagonalAC.setAttribute('y1', rhombus.A.y);
                diagonalAC.setAttribute('x2', rhombus.C.x);
                diagonalAC.setAttribute('y2', rhombus.C.y);
                diagonalAC.setAttribute('stroke', '#FF9800');
                diagonalAC.setAttribute('stroke-width', '2');
                diagonalAC.setAttribute('stroke-dasharray', '5,5');
                svg.appendChild(diagonalAC);
                
                // 对角线BD
                const diagonalBD = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                diagonalBD.setAttribute('x1', rhombus.B.x);
                diagonalBD.setAttribute('y1', rhombus.B.y);
                diagonalBD.setAttribute('x2', rhombus.D.x);
                diagonalBD.setAttribute('y2', rhombus.D.y);
                diagonalBD.setAttribute('stroke', '#FF9800');
                diagonalBD.setAttribute('stroke-width', '2');
                diagonalBD.setAttribute('stroke-dasharray', '5,5');
                svg.appendChild(diagonalBD);
                
                // 对角线交点
                const intersection = {
                    x: (rhombus.A.x + rhombus.C.x) / 2,
                    y: (rhombus.A.y + rhombus.C.y) / 2
                };
                const intersectionCircle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                intersectionCircle.setAttribute('cx', intersection.x);
                intersectionCircle.setAttribute('cy', intersection.y);
                intersectionCircle.setAttribute('r', '5');
                intersectionCircle.setAttribute('fill', '#FF5722');
                svg.appendChild(intersectionCircle);
            }
        }
        
        // 更新菱形数据和显示
        function updateRhombus() {
            currentSideLength = parseInt(sideLengthSlider.value);
            currentAngle = parseInt(angleSlider.value);
            
            sideLengthValue.textContent = currentSideLength;
            angleValue.textContent = currentAngle;
            
            // 计算菱形顶点
            rhombus = calculateRhombus(currentSideLength, currentAngle);
            
            // 绘制菱形
            drawRhombus();
            
            // 更新属性显示
            updateProperties();
        }
        
        // 更新属性显示
        function updateProperties() {
            // 边长计算
            const sideLenAB = distance(rhombus.A.x, rhombus.A.y, rhombus.B.x, rhombus.B.y).toFixed(1);
            const sideLenBC = distance(rhombus.B.x, rhombus.B.y, rhombus.C.x, rhombus.C.y).toFixed(1);
            const sideLenCD = distance(rhombus.C.x, rhombus.C.y, rhombus.D.x, rhombus.D.y).toFixed(1);
            const sideLenDA = distance(rhombus.D.x, rhombus.D.y, rhombus.A.x, rhombus.A.y).toFixed(1);
            
            // 角度计算
            const angA = calcAngle(rhombus.D, rhombus.A, rhombus.B).toFixed(1);
            const angB = calcAngle(rhombus.A, rhombus.B, rhombus.C).toFixed(1);
            
            // 更新边长显示
            abLen.textContent = sideLenAB;
            bcLen.textContent = sideLenBC;
            cdLen.textContent = sideLenCD;
            daLen.textContent = sideLenDA;
            
            // 更新角度显示
            angleA.textContent = angA;
            angleB.textContent = angB;
            
            // 对角线相关属性
            if (showDiagonal) {
                const ac = distance(rhombus.A.x, rhombus.A.y, rhombus.C.x, rhombus.C.y).toFixed(1);
                const bd = distance(rhombus.B.x, rhombus.B.y, rhombus.D.x, rhombus.D.y).toFixed(1);
                const angBAC = calcAngle(rhombus.B, rhombus.A, {
                    x: rhombus.A.x + 100, // 水平参考线
                    y: rhombus.A.y
                }).toFixed(1);
                const angCAD = calcAngle(rhombus.C, rhombus.A, {
                    x: rhombus.A.x + 100, // 水平参考线
                    y: rhombus.A.y
                }).toFixed(1);
                
                acLen.textContent = ac;
                bdLen.textContent = bd;
                // 菱形对角线互相垂直
                diagAngle.textContent = '90.0';
                angleBAC.textContent = angBAC;
                angleCAD.textContent = angCAD;
            } else {
                acLen.textContent = '--';
                bdLen.textContent = '--';
                diagAngle.textContent = '--';
                angleBAC.textContent = '--';
                angleCAD.textContent = '--';
            }
        }
        
        // 切换对角线显示
        function toggleDiagonals() {
            showDiagonal = !showDiagonal;
            toggleDiagonalsBtn.textContent = showDiagonal ? '隐藏对角线' : '显示对角线';
            drawRhombus();
            updateProperties();
        }
        
        // 重置
        function reset() {
            sideLengthSlider.value = 100;
            angleSlider.value = 60;
            showDiagonal = false;
            toggleDiagonalsBtn.textContent = '显示对角线';
            updateRhombus();
        }
        
        // 事件监听
        sideLengthSlider.addEventListener('input', updateRhombus);
        angleSlider.addEventListener('input', updateRhombus);
        toggleDiagonalsBtn.addEventListener('click', toggleDiagonals);
        resetBtn.addEventListener('click', reset);
        
        // 初始化
        updateRhombus();
    </script>
</body>
</html>