<!DOCTYPE html>
<html>
<head>
<style>
/* 全局样式：流式布局，自适应屏幕 */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}
body {
  padding: 15px;
  background-color: #f8f9fa; /* 页面背景色：浅灰蓝，柔和不刺眼 */
}
/* 课件标题区域：包含主标题和作者 */
.title-area {
  width: 100%;
  max-width: 800px;
  margin: 0 auto 20px;
  text-align: center;
}
/* 主标题：优化颜色，增强视觉层次 */
.main-title {
  font-family: "Microsoft YaHei", "Helvetica Neue", Arial, sans-serif;
  font-size: 18px;
  font-weight: bold;
  color: #1976D2; /* 主标题色：深天空蓝，专业醒目 */
  line-height: 1.5;
  margin-bottom: 8px;
  text-shadow: 0 1px 2px rgba(0,0,0,0.08); /* 轻微阴影，更有质感 */
}
/* 作者信息：优化颜色，更显精致 */
.author {
  font-family: "Microsoft YaHei", "Helvetica Neue", Arial, sans-serif;
  font-size: 14px;
  color: #546E7A; /* 作者色：深灰色，沉稳不突兀 */
  letter-spacing: 0.5px;
}
/* 1. 题目文本框：美化背景和边框 */
.question-box {
  width: 100%;
  max-width: 800px;
  margin: 0 auto 15px;
  padding: 10px;
  border: 2px solid #42A5F5; /* 题目边框：浅蓝，清新 */
  border-radius: 8px; /* 圆角增大，更柔和 */
  background-color: #ffffff; /* 题目背景：纯白，突出文字 */
  font-family: "Microsoft YaHei", "Helvetica Neue", Arial, sans-serif;
  font-size: 15px;
  line-height: 1.4;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05); /* 轻微阴影，增强立体感 */
}
.question-title {
  font-weight: bold;
  color: #D32F2F; /* 题目小标题色：深红，醒目 */
  margin-bottom: 5px;
  font-size: 17px;
}
.question-blank {
  display: inline-block;
  width: 55px;
  height: 22px;
  border-bottom: 2px solid #333;
  vertical-align: middle;
  margin: 0 4px;
}
/* 2. 图形区域：美化背景和边框 */
.graph-box {
  width: 100%;
  max-width: 400px;
  height: 250px;
  margin: 0 auto 20px;
  background-color: #E3F2FD; /* 图形背景：浅蓝，清新柔和 */
  border-radius: 8px;
  border: 1px solid #BBDEFB; /* 图形边框：淡蓝，精致 */
  box-shadow: 0 2px 6px rgba(0,0,0,0.06); /* 阴影增强立体感 */
}
#mainSVG {
  width: 100%;
  height: 100%;
}
/* 3. 滑动条区域：美化滑动条样式 */
.slider-box {
  width: 100%;
  max-width: 280px;
  margin: 0 auto 20px;
}
.slider-container {
  margin-bottom: 12px;
}
.slider {
  width: 100%;
  height: 6px;
  accent-color: #2196F3; /* 滑动条主题色：天空蓝，与标题呼应 */
  border-radius: 3px; /* 滑动条圆角，更精致 */
  margin: 0;
  cursor: pointer;
}
.slider-label {
  text-align: center;
  font-family: "Microsoft YaHei", "Helvetica Neue", Arial, sans-serif;
  font-size: 12px;
  margin-top: 3px;
  color: #455A64; /* 滑动条标签色：深灰，清晰 */
}
/* 4. 思考提示框：美化颜色和过渡 */
.think-hint {
  width: 100%;
  max-width: 800px;
  margin: 0 auto;
  padding: 8px;
  border: 2px solid #FFB74D; /* 思考框边框：浅橙，温暖 */
  border-radius: 8px;
  background-color: #FFF8E1; /* 思考框背景：浅黄，柔和醒目 */
  font-family: "Microsoft YaHei", "Helvetica Neue", Arial, sans-serif;
  font-size: 13px;
  color: #E65100; /* 思考文字色：深橙，突出重点 */
  text-align: center;
  opacity: 0;
  transition: opacity 0.3s ease, box-shadow 0.3s ease; /* 新增阴影过渡 */
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}
/* 思考框显示时添加阴影，增强层次感 */
.think-hint:hover {
  box-shadow: 0 3px 6px rgba(0,0,0,0.08);
}
</style>
</head>
<body>
<!-- 标题区域：主标题 + 作者 -->
<div class="title-area">
  <h2 class="main-title">陕西省2022年中考试题副题<br>13题的动态演示</h2>
  <div class="author">作者：雷新风</div>
</div>

<!-- 1. 题目文本框 -->
<div class="question-box">
  <div class="question-title">陕西2022年中考数学试题（副题）</div>
  <div class="question-content">
    如图，在菱形ABCD中，边长为12，∠C=60°。点P是边BC上的一个动点，连接AP。过点D作AP的平行线EF，使EF=AP。连接AE、PF，形成平行四边形AEFP。则平行四边形AEFP的面积为<span class="question-blank"></span>。
  </div>
</div>

<!-- 2. 图形区域 -->
<div class="graph-box">
  <svg id="mainSVG" xmlns="http://www.w3.org/2000/svg"></svg>
</div>

<!-- 3. 滑动条区域 -->
<div class="slider-box">
  <div class="slider-container">
    <input type="range" class="slider" id="sliderPInput" min="0" max="100" value="50">
    <div class="slider-label">控制动点P：<span id="sliderPValue">50</span>%</div>
  </div>
  <div class="slider-container">
    <input type="range" class="slider" id="sliderDPInput" min="0" max="100" value="0">
    <div class="slider-label">绘制DP连线：<span id="sliderDPValue">0</span>%</div>
  </div>
</div>

<!-- 4. 思考提示框 -->
<div class="think-hint" id="thinkHint">
  思考：① 三角形APD与菱形ABCD的面积有什么关系？② 三角形APD与平行四边形AEFP的面积有什么关系？
</div>

<script>
// 基础参数
const L = 100;
const baseStrokeWidth = L/45;
const fixedX = 200;
const fixedY = 125;
let tP = 0.5;
let tDP = 0;
const thinkHint = document.getElementById('thinkHint');

// 菱形顶点
const diamondPoints = (() => {
  const h = L * Math.sqrt(3)/2;
  const A = { x: fixedX - L/2, y: fixedY + h/2 };
  const B = { x: fixedX + L/2, y: fixedY + h/2 };
  const D = { x: fixedX,        y: fixedY - h/2 };
  const dx = D.x - B.x;
  const dy = D.y - B.y;
  const det = dx*dx + dy*dy;
  const a = (dx*dx - dy*dy)/det;
  const b = 2*dx*dy/det;
  const C = {
    x: a*(A.x - B.x) + b*(A.y - B.y) + B.x,
    y: b*(A.x - B.x) - a*(A.y - B.y) + B.y
  };
  return { A, B, C, D };
})();
const { A, B, C, D } = diamondPoints;

// 计算P点
function calculatePointP(B, C, t) {
  return { x: B.x + t*(C.x - B.x), y: B.y + t*(C.y - B.y) };
}

// 计算EF
function calculateEF(A, P, D) {
  const apVec = { x: P.x - A.x, y: P.y - A.y };
  const halfApVec = { x: apVec.x/2, y: apVec.y/2 };
  return {
    E: { x: D.x - halfApVec.x, y: D.y - halfApVec.y },
    F: { x: D.x + halfApVec.x, y: D.y + halfApVec.y }
  };
}

// 计算DP路径
function calculateDPPath(D, P, t) {
  const currentX = D.x + t*(P.x - D.x);
  const currentY = D.y + t*(P.y - D.y);
  return `M${D.x},${D.y} L${currentX},${currentY}`;
}

// 控制思考文字渐显
function updateHintOpacity(t) {
  thinkHint.style.opacity = t;
}

// 绘制图形（优化线条颜色，更协调）
function render() {
  const P = calculatePointP(B, C, tP);
  const { E, F } = calculateEF(A, P, D);
  const dpPath = calculateDPPath(D, P, tDP);
  const svg = document.getElementById('mainSVG');

  svg.setAttribute('viewBox', `${fixedX - L*1.1} ${fixedY - L*1.1} ${L*2.2} ${L*2.2}`);

  // 更新思考文字透明度
  updateHintOpacity(tDP);

  // 优化图形元素颜色，与整体风格呼应
  svg.innerHTML = `
    <!-- 图形背景 -->
    <rect x="${fixedX - L*1.1}" y="${fixedY - L*1.1}" width="${L*2.2}" height="${L*2.2}" fill="#E3F2FD" rx="4"/>
    <!-- 菱形ABCD：深灰蓝，稳重 -->
    <path d="M${A.x},${A.y} L${B.x},${B.y} L${C.x},${C.y} L${D.x},${D.y} Z" stroke="#3949AB" stroke-width="${baseStrokeWidth}" fill="none"/>
    <!-- 动点P：深红，醒目 -->
    <circle cx="${P.x}" cy="${P.y}" r="${L/22}" fill="#D32F2F"/>
    <!-- AP线段：橙色，温暖 -->
    <path d="M${A.x},${A.y} L${P.x},${P.y}" stroke="#FF9800" stroke-width="${baseStrokeWidth*0.8}" fill="none" stroke-dasharray="${L/12} ${L/24}"/>
    <!-- DP连线：深蓝，专业 -->
    <path d="${dpPath}" stroke="#1976D2" stroke-width="${baseStrokeWidth*0.9}" fill="none" stroke-linecap="round" stroke-dasharray="${L/15} ${L/30}"/>
    <!-- EF线段：紫色，柔和 -->
    <path d="M${E.x},${E.y} L${F.x},${F.y}" stroke="#7B1FA2" stroke-width="${baseStrokeWidth*0.8}" fill="none" stroke-dasharray="${L/12} ${L/24}"/>
    <!-- D点：浅蓝，清新 -->
    <circle cx="${D.x}" cy="${D.y}" r="${L/33}" fill="#42A5F5"/>
    <!-- 平行四边形AEFP：浅绿，清新 -->
    <path d="M${A.x},${A.y} L${E.x},${E.y} L${F.x},${F.y} L${P.x},${P.y} Z" stroke="#4CAF50" stroke-width="${baseStrokeWidth*0.8}" fill="rgba(76,175,80,0.1)"/>
    <!-- 顶点标签：深灰，清晰 -->
    ${[
      { point: A, label: 'A', dx: -L*0.08, dy: L*0.08 },
      { point: B, label: 'B', dx: L*0.08, dy: L*0.08 },
      { point: C, label: 'C', dx: L*0.08, dy: -L*0.08 },
      { point: D, label: 'D', dx: -L*0.08, dy: -L*0.08 },
      { point: P, label: 'P', dx: L*0.08, dy: -L*0.08 },
      { point: E, label: 'E', dx: -L*0.08, dy: -L*0.08 },
      { point: F, label: 'F', dx: L*0.08, dy: L*0.08 }
    ].map(({point, label, dx, dy}) => `
      <text x="${point.x}" y="${point.y}" dx="${dx}" dy="${dy}" style="font-size:${L/10}px; font-family:Times New Roman; fill:#455A64">${label}</text>
    `).join('')}
  `;
}

// 滑动条事件
document.getElementById('sliderPInput').addEventListener('input', (e) => {
  tP = e.target.value/100;
  document.getElementById('sliderPValue').textContent = e.target.value;
  render();
});
document.getElementById('sliderDPInput').addEventListener('input', (e) => {
  tDP = e.target.value/100;
  document.getElementById('sliderDPValue').textContent = e.target.value;
  render();
});

// 初始化
render();
window.addEventListener('resize', render);
</script>